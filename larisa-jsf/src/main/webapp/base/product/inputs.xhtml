<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core">
    <h:outputScript library="js" name="ui-galleria-panel.js"/>


    <p:panelGrid columnClasses="labelClass">
        <p:row>
            <p:column styleClass="labelClass">
                <p:outputLabel for="id" value="Код:"/>
            </p:column>
            <p:column>
                <p:inputText disabled="true" id="id"
                             value="#{productEditor.selected.id}"/>
            </p:column>
        </p:row>
        <p:row>
            <p:column styleClass="labelClass">
                <p:outputLabel for="date" value="Дата:"/>
            </p:column>
            <p:column>
                <p:calendar id="date"
                            value="#{productEditor.selected.date}"
                            converter="#{localDateConverter}"
                            pattern="dd.MM.yy"
                            size="#{msg.dateSize}"
                            maxlength="#{msg.dateSize}"
                            required="true"
                            requiredMessage="Поле 'Дата' обязательно для заполнения"/>
            </p:column></p:row>
        <p:row>
            <p:column styleClass="labelClass">
                <p:outputLabel for="productType" value="Вид продукции:"/>
            </p:column>
            <p:column>
                <p:autoComplete id="productType"
                                value="#{productEditor.selected.productType}"
                                completeMethod="#{productTypeService.findByMaskAndEmptyChilds}"
                                style="width: 100%"
                                required="true"
                                requiredMessage="'Вид продукции' обязательно для заполнения"
                                converter="#{productTypeEditor}"
                                var="e"
                                forceSelection="true"
                                itemLabel="#{e.name}"
                                itemValue="#{e}"
                                inputStyle="width: 40em">
                    <p:ajax event="query" global="false"/>
                    <!--@elvariable id="e" type="larisa.entity.ProductType"-->

                    <p:column>#{e.name}</p:column>
                    <p:column>#{e.maker.name}</p:column>
                </p:autoComplete>
            </p:column>
            <p:column>
                <p:commandLink style="text-decoration: none"
                               styleClass="fa fa-fw fa-plus"
                               process="@this"
                               update="productTypePanel">
                    <f:setPropertyActionListener value="#{true}" target="#{productEditor.productTypeEdit}"/>
                </p:commandLink>
            </p:column>
        </p:row>
        <p:row>
            <p:column colspan="3">
                <p:outputPanel id="productTypePanel">
                    <p:panel rendered="#{productEditor.productTypeEdit}" header="Вид продукции">
                        <f:subview id="productTypeInputs">
                            <h:panelGroup layout="block">
                                <ui:include src="../productType/inputs.xhtml"/>
                                <h:panelGrid style="margin: auto" columns="2">
                                    <p:commandButton icon="fa fa-fw fa-plus" process="productTypeInputs"
                                                     actionListener="#{productTypeEditor.save()}"
                                                     update="@form">
                                        <f:setPropertyActionListener value="#{productTypeEditor.selected}"
                                                                     target="#{productEditor.selected.productType}"/>
                                        <f:setPropertyActionListener value="#{false}"
                                                                     target="#{productEditor.productTypeEdit}"/>
                                    </p:commandButton>
                                    <p:commandButton icon="fa fa-fw fa-ban" process="@this" update="@form:productType @form:productTypePanel">
                                        <f:setPropertyActionListener value="#{false}"
                                                                     target="#{productEditor.productTypeEdit}"/>
                                    </p:commandButton>
                                </h:panelGrid>
                            </h:panelGroup>

                        </f:subview>
                    </p:panel>
                </p:outputPanel>
            </p:column>
        </p:row>
        <p:row>
            <p:column styleClass="labelClass">
                <p:outputLabel for="volume" value="Количество:"/>
            </p:column>
            <p:column>
                <p:inputText id="volume" value="#{productEditor.selected.volume}" required="true"
                             requiredMessage="Поле 'Количество' обязательно для заполнения">
                    <f:convertNumber integerOnly="true"/>
                </p:inputText>
            </p:column>
        </p:row>
        <p:row>
            <p:column styleClass="labelClass">
                <p:outputLabel for="price" value="Цена:"/></p:column>
            <p:column>
                <p:inputText id="price" value="#{productEditor.selected.price}" required="true"
                             requiredMessage="Поле 'Цена' обязательно для заполнения">
                    <f:convertNumber/>
                </p:inputText>
            </p:column>
        </p:row>
        <p:row>
            <p:column styleClass="labelClass">
                <p:outputLabel for="expirationDate" value="Срок годности:"/>
            </p:column>
            <p:column>
                <p:calendar id="expirationDate"
                            value="#{productEditor.selected.expirationDate}"
                            converter="#{localDateConverter}"
                            pattern="dd.MM.yy"
                            size="#{msg.dateSize}"
                            maxlength="#{msg.dateSize}"
                            required="false"
                            requiredMessage="Поле 'Срок годности' обязательно для заполнения"/>
            </p:column>
        </p:row>
    </p:panelGrid>
</ui:composition>